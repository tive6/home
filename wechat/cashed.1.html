<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="keywords" content="八斗金服">
  <meta name="description" content="八斗金服">
  <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />
  <!--<base href="http://192.168.0.220:8022/" />-->
  <title>账户提现</title>
  <link rel="stylesheet" type="text/css" href="weixin/css/wechat.css" />
  <script src="weixin/js/require.js" data-main="weixin/js/main" defer="defer" async="async" type="text/javascript" charset="utf-8"></script>
  <script>
    window.onload = function () {
      require.config({
        baseUrl: 'weixin/js',
        paths: {
          // 外部库／插件
          'jquery': [
            '//cdn.bootcss.com/jquery/1.12.4/jquery.min',
            'lib/jquery/1.12.4/jquery.min'
          ],
          'config': 'settings',
          'investController': 'controller/investController',
          'userController': 'controller/userController'
        }
      });
      require([
        'jquery', 'config', 'investController', 'userController'
      ], function ($, config, investController, userController) {
        var hasBinded = false;
        userController.loadUserAuthResult(function (user) {
          if (!user.getIsAuth()) {
            $('#cashed').on('click', function () {
              WebView.msgAlert({
                msg: '请先进行实名认证。',
                action: function () {
                  parent.window.location = config.BASE_URL + config.PAGE_URI_MAP.REALNAME_AUTH_PAGE
                }
              }).show();
            });
          } else {
            userController.getMyAsset(function (asset) {
              if (+asset.getCABalance()) {
                $('#cashedBalance').html(asset.getCABalance());

                $('#cashedInput').on('input', function () {
                  var val = $(this).val();
                  if (val) {
                    if (!hasBinded) {
                      hasBinded = true;
                      $('#cashed').on('click', function () {
                        var options = {
                          balance: +asset.getCABalance(),
                          amt: +$('#cashedInput').val(),
                          type: 'withdraw',
                          source: decodeURIComponent(window.location.href)
                        };
                        investController.rechargeOrWithdraw(options, function (fuiou) {
                          $('[name="login_id"]').val(fuiou.getLoginId());
                          $('[name="mchnt_txn_ssn"]').val(fuiou.getMchntTxnSsn());
                          $('[name="mchnt_cd"]').val(fuiou.getMchntCd());
                          $('[name="signature"]').val(fuiou.getSignature());
                          $('[name="back_notify_url"]').val(fuiou.getBackNotifyUrl());
                          $('[name="amt"]').val(fuiou.getAmt());
                          $('[name="page_notify_url"]').val(fuiou.getPageNotifyUrl());
                          $('#__sbform__').submit();
                        });
                      }).removeClass('btn-disabled');
                    }
                  } else {
                    hasBinded = false;
                    $('#cashed').off('click').addClass('btn-disabled');
                  }
                });
              }
            });
          }
        });

        investController.getBankCard(function (bank) {
          if (bank) {
            $('#bankName').html(bank.getName())
              .prev().show();
              var bankCode =bank.getCode();
              var bankMap={
              	"0308" : "bank-zs",
              	"0102" : "bank-gs",
              	"0103" : "bank-ny",
              	"0105" : "bank-js",
              	"0403" : "bank-yz",
              	"0104" : "bank-china",
              	"0301" : "bank-jt",
              	"0305" : "bank-ms",
              	"0303" : "bank-gd",
              	"0309" : "bank-xy",
              	"0306" : "bank-gf",
              	"0307" : "bank-pa",
              	"0302" : "bank-zx",
              	"0304" : "bank-hx",
              	"0310" : "bank-pf"
              	
              };
            	$('#bankName').prev().addClass(bankMap[bankCode]);//.removeClass("icon-add")
            
            $('#trailNumber').html('尾号(' + bank.getNumber() + ')').show();
            $('#gotoRealAuth:after').hide();
          } else {
            $('#gotoRealAuth').on('click', function () {
              window.location = config.BASE_URL + config.PAGE_URI_MAP.REALNAME_AUTH_PAGE;
            });
          }
        });

        $('#__sbform__').attr('action', config.SERVICE_URI_MAP.FUIOU_WITHDRAW);
      });
    };
  </script>
</head>

<body class="cashed-page gray-bg">
  <span id="loading" style="display:none;">loading...</span>
  <div class="cashed-page-wrapper">
    <div class="scroll-content">
      <div class="cashed-group">
        <span>账户余额(元)</span>
        <span id="cashedBalance" class="cashed">0.00</span>
      </div>
      <div id="bankCard" class="cashed-group cashed-bank-group has-card">
        <span class="bank-icon icon-add"></span>
        <span id="bankName" class="cashed-bank-name">添加银行卡</span><span id="trailNumber" class="pull-right trail-number">尾号（0000）</span>
        <a id="gotoRealAuth" class="read-more-arrow" href="javascript:void(0);"></a>
      </div>
      <div class="horizontal-input cashed-group">
        <label for="">提现金额(元)</label>
        <input type="number" name="n_bank_card_id" id="cashedInput" class="form-control" value="" placeholder="请输入提现金额" />
      </div>
      <div class="btn-group cashed-btn">
        <button id="cashed" class="btn btn-primary btn-disabled">立即提现</button>
        <div class="bank-notice">
        </div>
      </div>
      <div class="cashed-prompt">
        <h2>温馨提示：</h2>
        <p>1、您的账户资金将通过富友第三方平台进行提现。</p>
        <p>2、绑定快捷支付卡后，该卡将成为唯一的提现卡，如需解绑请联系网站客服。</p>
        <p>3、禁止洗钱、信用卡套现、虚假交易等行为，一经发现确认，将终止该账户的使用。</p>
        <p>4、如果提现金额没有及时到账，请联系八斗客服400-168-8885或直接联系富友平台95138进行查询。</p>
      </div>
    </div>
  </div>
  <form id="__sbform__" method="post">
    <input type="hidden" name="login_id" value="" />
    <input type="hidden" name="mchnt_txn_ssn" value="" />
    <input type="hidden" name="mchnt_cd" value="" />
    <input type="hidden" name="signature" value="" />
    <input type="hidden" name="back_notify_url" value="" />
    <input type="hidden" name="amt" value="" />
    <input type="hidden" name="page_notify_url" value="" />
  </form>
</body>

</html>